import { readFileSync } from 'node:fs';
import { describe, expect, test } from 'vitest';

describe('index.html wiring', () => {
  test('contains IDs used by src/main.js', () => {
    const html = readFileSync(new URL('../index.html', import.meta.url), 'utf-8');
    const requiredIds = [
      'editor',
      'preview',
      'preview-content',
      'render-status',
      'render-now',
      'jump-error',
      'focus-toggle',
      'zoom-out',
      'zoom-in',
      'zoom-reset',
      'zoom-label',
      'stats',
      'health',
      'instructions',
      'proposal',
      'generate-patch',
      'cancel-generate-patch',
      'ai-api-base',
      'ai-model',
      'ai-api-mode',
      'ai-temperature',
      'ai-max-tokens',
      'ai-timeout',
      'ai-api-key',
      'ai-remember-key',
      'ai-status',
      'patch-undo',
      'undo-patch',
      'diff',
      'timeline',
      'theme-toggle',
      'copy-link',
      'copy-link-newtab',
      'copy-snapshot',
      'copy-snapshot-import',
      'download-bundle',
      'help',
      'shortcuts-dialog',
      'shortcuts-close',
      'import-url-dialog',
      'import-url-close',
      'import-url-input',
      'import-url-submit',
      'import-url-cancel',
      'presentation-mode',
      'presentation-dialog',
      'presentation-close',
      'presentation-prev',
      'presentation-next',
      'presentation-fullscreen',
      'presentation-meta',
      'presentation-status',
      'presentation-content',
      'toast',
      'readonly-banner',
      'template-search',
      'template-filters',
      'template-grid',
      'template-empty',
      'prompt-recipes',
      'tab-list',
      'add-tab',
      'duplicate-tab',
      'rename-tab',
      'delete-tab',
      'project-title',
      'project-audience',
      'project-owner',
      'project-purpose',
      'use-filenames',
      'commit',
      'simulate',
      'apply-patch',
      'export-svg',
      'export-png',
      'export-pdf',
      'format-mermaid',
      'copy-source',
      'copy-svg',
      'copy-png',
      'reset',
      'clear-history',
      'download-history',
      'restore-draft',
      'clear-draft',
      'download-source',
      'import-file-btn',
      'import-url-btn',
      'import-file',
      'export-scale',
      'export-width',
      'export-width-custom',
      'export-transparent',
      'export-svg-scale',
      'export-svg-inline',
      'export-svg-minify',
      'pdf-page',
      'pdf-orientation',
      'pdf-margin',
      'pdf-white-bg',
      'export-summary',
      'export-preset',
      'export-preset-name',
      'save-preset',
      'delete-preset',
      'download-export-history',
      'export-history',
    ];

    requiredIds.forEach((id) => {
      expect(html).toContain(`id="${id}"`);
    });
  });
});
